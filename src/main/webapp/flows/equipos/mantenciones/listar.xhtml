<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:tvp="http://transportesventanas.cl"
                template="/templates/default.xhtml">

    <ui:define name="contenido">

        <h2>Listado de Mantenciones</h2>
        <p:messages autoUpdate="true" showDetail="true" closable="true"/>
        <h:form id="formMantenciones" enctype="multipart/form-data">
            <p:panel rendered="#{sesionCliente.esAdministrador(constantes.getModuloMantenciones())}"
                     header="Información Copec">
                <h:panelGrid columns="3">
                    <h:outputLabel for="iFecha" value="Última Actualización"/>:
                    <p:inputText readonly="true" id="iFecha" value="#{importadorDatosCopec.ultimaActualizacion}">
                        <f:convertDateTime pattern="dd-MM-yyyy"/>
                    </p:inputText>
                    <h:outputLabel for="iArchivo" value="Cargar Nuevos Datos"/>:
                    <p:fileUpload value="#{importadorDatosCopec.archivo}" id="iArchivo" mode="simple"/>
                </h:panelGrid>
                <p:commandButton action="#{importadorDatosCopec.subir}" ajax="false" icon="ui-icon-arrowthickstop-1-n"
                                 value="Subir"/>
            </p:panel>
            <p:fieldset legend="Filtros">
            <h:panelGrid columns="3">
                <p:outputLabel value="Mes"/>:
                <p:inputText value="#{flowScope.mes}"/>
                <p:outputLabel value="Año"/>:
                <p:inputText value="#{flowScope.anio}"/>
                <p:commandButton value="Actualizar Filtros" update=":formMantenciones"
                                 action="#{tabsMantenciones.actualizarFiltros()}"/>
            </h:panelGrid>
        </p:fieldset>
            <p:tabView>
                <p:ajax event="tabChange" listener="#{tabsMantenciones.onTabChange}" update=":formMantenciones"/>
                
                <ui:include src="/flows/equipos/mantenciones/includes/tracto.xhtml"/>
                <ui:include src="/flows/equipos/mantenciones/includes/semiremolque.xhtml"/>
                <ui:include src="/flows/equipos/mantenciones/includes/maquinaria.xhtml"/>
            </p:tabView>
        </h:form>
        <h:outputScript library="js" target="body">
            WebCenter.Filter.run('tTractos');
        </h:outputScript>
    </ui:define>
</ui:composition>